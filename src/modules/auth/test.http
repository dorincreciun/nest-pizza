### Variabile Globale
@baseUrl = http://localhost:3000
@email = creciun@pizza.com
@password = ParolaComplexa123!
@username = dorin_pizzaboy

### 1. REGISTER - Creare cont nou
# @name registerSuccess
POST {{baseUrl}}/auth/register
Content-Type: application/json

{
  "email": "{{email}}",
  "username": "{{username}}",
  "password": "{{password}}"
}

### 2. LOGIN - Autentificare (Obținem Access și Refresh)
# @name loginSuccess
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "email": "{{email}}",
  "password": "{{password}}"
}

> {%
    client.test("Login reușit", function() {
        client.assert(response.status === 201, "Status 201");
        // Salvăm ambele token-uri pentru pașii următori
        client.global.set("auth_accessToken", response.body.tokens.accessToken);
        client.global.set("auth_refreshToken", response.body.tokens.refreshToken);
    });
%}

### 3. REFRESH TOKEN - Obținem un Access Token nou folosind Refresh-ul
# @name refreshTest
POST {{baseUrl}}/auth/refresh-token
Content-Type: application/json

{
  "refreshToken": "{{auth_refreshToken}}"
}

> {%
    client.test("Refresh reușit", function() {
        client.assert(response.status === 201, "Status 201");
        client.assert(response.body.accessToken, "Lipsește noul Access Token");
        // Actualizăm variabila globală cu noul Access Token primit
        client.global.set("auth_accessToken", response.body.accessToken);
    });
%}

### 4. LOGOUT - Ștergere sesiune (Folosind noul Access Token)
POST {{baseUrl}}/auth/logout
Authorization: Bearer {{auth_accessToken}}
Content-Type: application/json

{}